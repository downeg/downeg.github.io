---
layout: default
title:  "Mirai Botnet Case Study"
date:   2023-11-10 09:00:00 +0000
categories: gdpr dora university assignment
---

# Cybersecurity Standards & Risks 
#### (University assignment)

> Letters from the CEO of a fictional bank (incorporated in Ireland, regulated by the Central Bank of Ireland.) to the board of directors regarding the cybersecurity posture of the company and discussing two cybersecurity incidents.

## Summary of risk environment and recommendations for NIST CSF (August 2023)

Dear board members,

We are living in a time of digital transformation and increased scrutiny on data protection laws. As an Irish bank it is our responsibility to conform to the regulations set out by the Central Bank of Ireland and by the European Union. Cyber Security operations are a constantly evolving area and will never be in a truly 'fixed' or completed state. We, as a financial institution, have an increased responsibility to our customers to keep their financial and personal data secure and safe from any unauthorised or accidental changes, while still having that data available for quick and easy processing should a legitimate need arise.

There are several ordinances set out by the EU regarding cyber security, data protection and data resilience that we as a financial institution are legally obliged to implement. Amongst these are the General Data Protection Regulations (GDPR) of 2018, the Data Protection Act of 2018 and the Digital Operational Resilience Act which is currently in effect and will become legally mandatory in January 2025.

GDPR is an EU regulation related to a living individual's right to privacy with regards to their personal information when it is collected, stored or otherwise processed by an EU based organisation. A non-exhaustive list of Personally Identifiable Information (PII) protected by GDPR includes name, date of birth, contact details, PPS number, financial data and anything that can be used to identify a person. Even CCTV footage taken of people visiting our branches and/or ATMs is protected under the GDPR. The regulation protects not only customer data, but also employee data. Any record or piece of data stored which can uniquely identify a person needs to be protected.

GDPR applies to PII for EU and non-EU citizens if the organisation collecting, storing and processing the PII is based in the EU. It also applies to the PII of EU citizens' if the data is being collected, stored and processed by an organisation based outside of the EU.

There are currently 11 chapters in the GDPR and I will briefly discuss chapters 2, 3 and 4 focussing on what I see as being most relevant to the bank.

Chapter 2 of the GDPR describes the ***Principals*** of GDPR. It states that any data collected about a person should be processed lawfully, fairly and in a transparent manner. A person’s data should only be collected for specified, explicit and legitimate purposes, should be kept accurate and up to data and should not be stored for longer than is necessary. Any data collection must be done so with the expressed consent of the individual and a record of that consent needs to be kept. Certain special categories of personal data cannot be processed, for example religious beliefs or ethnic origin.

Chapter 3 of the GDPR describes the ***Rights of the Data Subject*** regarding the data which we store and process about them. We have a legal obligation to inform the data subject (i.e., the individual) about how we process the information collected, and we need to provide a written explanation on how the data will be used. This written explanation should be easily accessible by the public. Any data subject can request a copy of their own personal data, and this must be provided in a timely manner. The data subject has the right to correct or rectify any data we store which may be inaccurate and to request that we restrict processing of incorrect data. Data subjects reserve the right to have their PII data completely erased. In such a case where a PII data erasure is requested the bank may be legally required to retain some PII for reasons of public interest or for defence of legal claims.

Chapter 4 of the GDPR describes the responsibilities of the ***Data Controller*** and the ***Data Processor***. We, the bank, act as both Data Controller and Data Processor of customer data as we perform the collection of the data, we manage the storage of the data, and we process the data. As Data Controller we are legally bound to "*implement appropriate technical and organisational measures*" to protect the data. Measures such as pseudonymisation and data minimisation should be implemented as a default in data collection. This means that data collection should be limited to what is absolutely required for specific processing. Personal data should not be stored for longer than what is absolutely required for processing and for legal purposes. As the Data Processor we cannot give away our customer data to third parties for any reason. This includes intentional and unintentional disclosure of information, malicious data breaches and data theft. We are also accountable to protect the data against unlawful destruction, loss and/or alteration. In the case of a personal data breach, we are legally obliged to inform our supervisory authority (the Central Bank of Ireland) within 72 hours of becoming aware of the breach.

The Digital Operational Resilience Act (DORA) is a new EU regulation that came into effect this year in January 2023. It is a new framework that aims to ensure that regulated financial institutions can withstand, respond to and recover from ICT related incidents, including cyber-attacks. The regulations focus on an organisation's ability to detect and respond incidents, be able to report and classify these incidents in a standardised manner and to regularly test the stability of any ICT security controls. These regulations not only apply to financial organisations, but also any third-party service provider that supplies any regulated financial institution for ITC systems and servers, for example cloud service providers and data centres. These DORA regulations are going to be enforced by law from January 2025.

These regulations may seem obvious and easy to implement, however a recent example of a GDPR breach by a top Irish bank is the February 2023 decision to fine Bank of Ireland the amount of €750,000 due to a fault in their online banking app where several users of the app were shown information about other people’s accounts.

So how do we protect the bank from being fined in such a manner? It is clear to me that investment into an effective cyber-security and data resilience program is vital.

The CIA triad is the foundation of any effective cyber security program. CIA stands for the Confidentiality, Integrity and Availability of data and IT systems. These broad terms may sometimes seem as if they work against each other, for example if we make data completely confidential then it may not be readily available to data processor needs. If data is made too available, then it's confidentiality may be affected. The key is to find the correct balance between the three.

A failure in the confidentiality and integrity of our IT infrastructure can have significant adverse financial, legal and reputational consequences. A failure in our IT infrastructure being available can lead to a loss of business, loss of customers and impact our ability to function as a financial institution. Over the past year we have focused on implementing a cyber security policy in line with the ***NIST Cyber Security Framework***. Split into three parts (Core, Profile and Tier) the NIST CSF covers all areas of the CIA triad.

The framework's ***Core*** is a list of activities and expected outcomes that can be implemented by an organisation to create a ***Profile***. Once an initial profile is implemented the effectiveness of the controls included can be tested and audited and then activities from the core can be added or removed to create a new target profile, which once implemented can again be tested and audited. Cyber security is constantly evolving and can be described as a race with no end. Being agile in our approach to developing and implementing improved profiles is how we will succeed in the highly regulated world of GDPR and DORA.

The implementation ***Tier*** then is how a company views its ability to mitigate cyber risks and how mature and effective the organisations cyber resilience program is. There are four tiers: Partial, Risk Informed, Repeatable and Adaptive. It is my view after last year's focus on implementation we are currently at Tier 2, ***Risk Informed***. We understand the risks that can lead to breaches of GDPR and DORA and we have our first profile implemented. We are in the process of developing the next profile. 

It is of utmost importance that the IT cyber defence strategies are aligned with all areas of the business. My opinion is that the NIST CSF can bring all our operations into compliance with GDPR and DORA. Our goal in this coming year is to develop and implement a CSF Profile that will bring us to a Tier 3 implementation, ***Repeatable***. In this tier we will have executive-approved risk management and cybersecurity best practices in place. Compliance with regards to cyber security will be implemented throughout the entire organisation, and not siloed to individual IT departments. Cyber security is everyone’s responsibility, and we need to lead this responsibility from the top. It is my recommendation that all cybersecurity budgetary requirements for the following year be approved by the board as investment now will prevent loss of profit and fines in the future.

Thanks,
CEO of The Bank

## REFERENCES
* [General Data Protection Regulation](https://gdpr.eu/tag/gdpr/)
* [ Official Journal of the European Union](https://eurlex.europa.eu/legal-content/EN/TXT/PDF/?uri=CELEX:32016R0679)
* [Principles relating to processing of personal data](https://gdpr.eu/article-5-how-to-process-personal-data/)
* [Conditions for consent](https://gdpr.eu/article-7-how-to-get-consent-to-collect-personal-data/)
* [Processing of special categories of personal data](https://gdpr.eu/article-9-processing-special-categories-of-personal-dataprohibited/)
* [Right to erasure](https://gdpr.eu/article-17-rightto-be-forgotten/)
* [Responsibility of the controller](https://gdpr.eu/article-24-responsibility-of-the-data-controller/)
* [Notification of a personal data breach to the supervisory authority](https://gdpr.eu/article-33-notification-of-a-personal-data-breach/)
* [Security of processing](https://gdpr.eu/article-32-security-of-processing/)
* [Notification of a personal data breach to the supervisory authority](https://gdpr.eu/article-33-notification-of-a-personal-data-breach/)
* [Implementing DORA](https://www.centralbank.ie/news-media/press-releases/implementing-doragerry-cross-28-march-2023)
* [What is the Digital Operational Resilience Act (DORA)?](https://www.ibm.com/topics/digital-operational-resilience-act)
* [Bank of Ireland Hit With a €750,000 GDPR Fine](https://www.itgovernance.eu/blog/en/bank-of-ireland-hit-with-a-e750000-gdpr-fine)
* [Inquiry into Bank of Ireland 365 ('BOI')](https://www.dataprotection.ie/en/resources/law/decisions/bank-of-ireland365-%28BOI%29-February-2023)

## Cyber incident report: Stolen laptop (September 2023)

Dear board members,

It has been reported that last week a laptop belonging to an employee has been stolen. It is not clear yet where the laptop was robbed from, whether it was left visible in a car, or removed from the employee home. No matter how the device was taken, it is the bank’s responsibility to ensure that we are compliant in our data protection controls as set out by the EU should such a loss of a device occur.

We have just become aware of the theft today, so we are within our 72 hours before we are obliged to report this to the Central Bank. As physical bank property has been stolen, we will also be reporting this to the Gardai. 

Our priority is to determine what information was contained on the device. The user’s login credentials were acquired by the thief as they were attached to the laptop screen on a '*Post-It*' note, so we can assume that the thief has full access to the device. Despite our efforts to protect our assets in line with the NIST CSF ***Protect*** core function, this laptop was released to the end user before the full suite of cybersecurity software was installed. Therefore, there is no ability to remote wipe the laptop, no full disk encryption enabled, and no VPN software installed. Thankfully the fact that there is no VPN software on the system means that the thief cannot log into our network using the stolen credentials. Any data which was downloaded onto the device from inside the network is still accessible to the thief. We will need to investigate the full extent of the data that was downloaded.

According to our investigation so far, the employee was involved in a loan trend analysis, and the loan applications for the Munster region for August 2023 have been downloaded locally to the device. Our teams are currently auditing the information of which the employee claims to have a locally stored copy on the device. The loan application data includes Personally Identifiable Information (PII) such as the name and address of applicants plus a digital copy of proof of PPS number amongst other data. 

As we have no ability to wipe the system remotely, we can assume that the thief has access to this data, so we are now in breach of GDPR rules. This accidental loss of personal data and the likelihood of unauthorised access will leave the bank open to an inquiry by the Central Bank of Ireland and a fine in respect of the infringement of Article 5(1)(f) of the GDPR. This paragraph of the GDPR states that data is "processed in a manner that ensures appropriate security of the personal data, including protection against unauthorised or unlawful processing and against accidental loss, destruction or damage, using appropriate technical or organisational measures". We have failed to protect our customer's data by not being stringent in our adhesion to the steps set out in our current NIST CSF Profile.

While we may have technical measures in place to mitigate against the loss of a physical device containing data, the fact that this device was allowed to be released to an employee without being put through the strict protect measures shows a major gap in the application of our cyber resilience plan across the different business units of the organisation. An unprotected laptop being used to download PII from the corporate network is completely unacceptable. 

Amongst the security measures already in place we have the NIST CSF core Protect function subcategory ***Data Security: Data-at-rest is protected (PR.DS-1)***. A control in place for this is to ensure that every mobile device has full disk encryption enabled are part of the cyber security suite before the laptop is approved for use by employees. This full disk encryption is enabled to protect data on devices that have been lost or stolen. The type of data that we intend to protect with the disk encryption is Outlook email and mail boxes that need to be stored locally. Full disk encryption is not
intended to protect customer PII, as the personal information should not be downloaded locally onto any device.

As part of this year’s cyber resilience program and to bring the organisation in line with the guidelines set out by the NIST CSF core Protect function category ***Identity Management, Authentication and Access Control (PR.AC)***, we are deploying a new internal online service for the processing of all stored customer data. This allows us to have a centralised administration over who is allowed to access customer data, and when they are allowed to do so in accordance with the PR.AC-4 subcategory which states "*access permissions and authorizations are managed, incorporating the principles of least privilege and separation of duties*".

This new service means that customer data should never need to be stored locally on any workstation or mobile devices (including laptops). If remote access to the data is required by employees, then the use of an encrypted virtual private network (VPN) is available to access our internal servers and services. The NIST CSF subcategory ***Remote access is managed” (PR.AC-3)*** covers the controls for allowing remote access. With multi-factor authentication (MFA) required for connecting to the VPN we can further protect our customer data from unauthorised access.

These controls mentioned so far, which are already in place, would protect our data in the event of a stolen mobile device. Having full disk encryption and no customer PII stored locally protects us from breaching GDPR rules. Having access to the customer data further protected by MFA access via a VPN would protect us in this case where the user credentials were stolen along with the device. However, having a new device being given to an employee before the device has been updated and protected by the IT department is a failing in our cyber security procedures. An employee’s ability to download customer data locally means that we need to step up our migration to the new online service. Finally, the fact that one of our employees will store their credentials on a '*Post-it*' note stuck to their mobile device shows that we need to focus once again on the training of our staff with regards to cyber security.

There have been reports from the branch managers that branch employees are too busy to attend cyber security training and a suggestion has come down from the executive level that it is ok to skip information security and cybersecurity awareness training. This is not the impression the executive level should be giving. Cyber security training is mandatory for all and every employee is responsible for keeping our data secure. There is an entire category listed in the NIST CSF that specifically covers ***Awareness and Training (PR.AT)***. In this category it mentions that "*senior executives understand their roles and responsibilities*". We need to lead the journey towards secure cyber operations from the top.

As part of our improved NIST CSF Profile this coming year we will target basic security training for all employees. Specialised programs will be run for any employees who have privileged access to data. A full migration to the online services will provide control over access and allow a principle of least privilege to be set up so that data confidentiality and integrity can be protected further. Legacy systems that allow personal data to be downloaded locally will be retired and shut down. There will not be any exceptions for any devices connecting to our network without first going through the application hardening process and being vetted by our IT team. We have already invested heavily in improving our cyber security stance with the NISF CSF this year, now it is time for us to ensure we use it.

Thanks,
CEO of The Bank

## REFERENCES
* [Principles relating to processing of personal data](https://gdpr-info.eu/art-5-gdpr/)
* [PR.DS-1: Data-at-rest is protected](https://csf.tools/reference/nist-cybersecurity-framework/v1-1/pr/pr-ds/prds-1/)
* [PR.AC-1: Identities and credentials](https://csf.tools/reference/nist-cybersecurity-framework/v1-1/pr/pr-ac/prac-1/)
* [Framework for Improving Critical Infrastructure Cybersecurity](https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf)
* [NIST 800-53 AC-17: Remote Access](https://csf.tools/reference/nist-sp-800-53/r5/ac/ac-17/)
* [PR.AT: Awareness and Training](https://csf.tools/reference/nist-cybersecurity-framework/v1-1/pr/pr-at/)

## Cyber incident report: Online Loans Application system compromised. (10 October 2023 )

Dear board members,

Early this morning at approximately 5am the cyber security incident response team detected and have been responding to a potential cyber-attack. At this moment we believe the attack is contained to the Online Loan Applications (OLA) system. As a precaution and to prevent the further spread of any malware infection the Online Loan Application servers have been isolated from the network for the digital forensics team to work on their investigation. Quarantining these servers off the network has resulted in our ability to take new loan applications from customers via our Internet facing banking portal. This business-critical service has been offline since 9am this morning.

The ICT department are in the process of standing up a new server cloned from the most recent backups that we have of the OLA server. This is going to take some time however as our current backup policy is application based rather than a full system backup. Therefore, once the hardware for the new server is procured the OS will need to be installed and fully patched before the team can being the process of cloning the applications from the backup servers. We have no baseline for a Recovery Time Objectives (RTO) as a disaster recovery project that was planned for last year had to be cancelled due to staff shortages. This lack of planning has left us totally unprepared for an incident like this.

There have been inquiries into a simple restore of the OLA applications onto the existing hardware. This will not be possible as we will need to keep the infected servers quarantined and available for a post recovery investigation into the capabilities of the malware. It is not known at this point if any customer data has been exfiltrated as part of the attack. If any customer personally identifiable information (PII) has been exfiltrated we will be in breach of GDPR regulations and open to an investigation by the Central Bank of Ireland and possible fines.

The attack vector appears to be compromised credentials which allowed the attacker to gain remote access to our internal network. We are confident that it is not related to last month’s laptop theft as the laptop did not have the VPN software required to connect back to the network. Credentials were obtained during last month’s theft; however, the corporate network login logs have been checked and there are no logins by that user which are not accounted for in the logs. The current hypothesis is that the credentials used in this current attack were obtained via a successful phishing attack.

The initial theory from the incident response team is that the stolen credentials were used to log in and deploy a backdoor which exploits a known vulnerability in the operating system installed on the OLA server. This vulnerability was publicly listed as a CVE on the 8th of September and there is a patch available from the vendor since the date the CVE was published. Despite the availability of the patch, our Internet facing OLA server was left vulnerable as the ICT department was too busy investigating last month’s stolen laptop to run the scheduled maintenance and update our servers. This completely avoidable situation we are in with today’s attack leads me to the following conclusions:

1. Our ICT team is understaffed and unable to keep up with the demands of keeping our ICT infrastructure secure.
2. Our current ICT infrastructure is not designed effectively and is not resilient enough to quickly recover from cyber-attacks.
3. Our entire staff is not knowledgeable enough in our obligations towards cyber-security and are not motivated enough to engage in cyber security training.

The following changes are to be made with immediate effect.

1. A new dedicated Cyber Security department is to be created and staffed through the new hiring of skilled individuals. The tasks of keeping our systems updated and the job of threat hunting and secure network operations is to be taken away from our current ICT department so that they can focus on their intended task of keeping the business applications and the hardware infrastructure up and running. The new Cyber Security team will work on improving the alignment of all business units to our obligations under the Digital Operations Resilience Act (DORA) which are to be enforced in January 2025. The team will be responsible for the planning, testing and implantation and documentation of any new ICT system focussing on security as a foundation. They will also be responsible for patch management and active vulnerability scanning and penetration testing.

2. The ICT server infrastructure is to be completely overhauled and transitioned from its current wasteful physical server per utility infrastructure to a consolidated virtual server environment. This transition to a virtual environment will enable simplified server maintenance as snapshots can be taken of the VMs before any patches are applied allowing for a more reliable roll-back in the case of issues after a patch is applied. With virtual servers the backup policy can be simplified allowing for much faster recovery time objectives and recovery point objectives as a full restore of a virtual server can be cloned back onto a hypervisor in a few hours compared to the possible RTO of days if new hardware needs to be purchased to replace a failed physical server. This project will be undertaken by the current ICT department now that they have been relieved of the burden of managing cyber-security as well as the ICT infrastructure.

3. As mentioned in a previous board meeting, we will need to take a new look at our training methods for the general staff in the area of cyber security. Login credentials being compromised because passwords are written down, or through phishing attacks is unacceptable. There is no point in having secure gates if the keys are being given away. The newly appointed Cyber Security team will design a completely new cyber security training program which will be mandatory for all staff members. Continued training and testing of the training will ensure that the responsibility of security is taken seriously by everyone.

These three initiatives will work towards improving our resilience and will enable us to be DORA compliant by January 2025. The dedicated Cyber Security team will have the expertise to comprehensively build and test our ICT infrastructure to make sure it is up to date and secure. The Cyber Security team will be trained in proper incident response, including the standardised reporting methodology. The virtualised server environment will allow us to respond and recover more quickly from a single compromised host, and a simplified VM based backup policy will reduce our RTO for bringing critical systems back online. Improved training programs and information sharing by the dedicated Cyber Security team will hopefully instil a proud sense of duty in all members of staff with regard to protecting our business our customers and our data from online threats.

Thanks,
CEO of The Bank

## REFERENCES
* [Digital Operational Resilience Act (DORA)](https://www.digital-operational-resilienceact.com/DORA_Article_5_(Proposal).html)
* [General requirements for the performance of digital operational resilience testing](https://www.dora-info.eu/article-24/)
* [DORA, Article 15, ICT-related incident management process.](https://www.digital-operational-resilienceact.com/DORA_Article_15_(Proposal).html)
* [DORA, Article 10, Response and recovery](https://www.digital-operational-resilienceact.com/DORA_Article_10_(Proposal).html)
* [DORA, Article 11, Backup policies and recovery methods](https://www.digital-operational-resilienceact.com/DORA_Article_11_(Proposal).html)
